<style>
  /* message style*/
  #message {
    color: green;
    display: none;
  }

  .container {
    width: 100%;
    margin: auto;
  }

  .nav-item button {
    border: 0px;
    margin-top: 6px;
  }

  nav form {
    margin-bottom: auto;
    margin-top: -4px;
  }
</style>

{{!-- navbar start --}}
<nav class="navbar navbar-expand-sm bg-dark navbar-dark nav justify-content-end">
  <form action="/logout" method="post">
    <ul class="nav mx-4">
      <li class="nav-item">
        <a class="nav-link text-light" href="#"><i class="fa fa-fw fa-home"></i>Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-light" href="/plan">Subscription</a>
      </li>
      <li class="nav-item">
        <button class="text-light bg-dark" <i class="fa-solid fa-arrow-right-from-bracket"></i>Logout</button>
      </li>
    </ul>
  </form>
</nav>
{{!-- navbar end --}}

{{!-- homepage start --}}
<div class="row" style="padding-left:20px; margin:0px;">
  <div class="col-12">
    <h1 class="ml-4 mt-3 mx-5">Total Upload File : {{total}}</h1>
    <h5 class="mx-5 mt-3">Subscription plan : {{plan}}</h5>
    <button type="button" class="btn btn-warning mb-3 mt-3 mx-5" data-bs-toggle="modal"
      data-bs-target="#exampleModalCenter">Upload Image</button>
  </div>

  {{#each files}}
  <div class="col-4">
    {{!-- display images --}}
    <div class="container mt-3">
      <section>
        <div class="row">
          <div class="col-3 m-3">
            <div class="card shadow" style="width: 18rem;">
              <img src='{{this.path}}' style="width:285px;height: 200px;" />
              <div class="card-body text-center">
                <h5 class="card-title font-poppins">{{this.name}}</h5>
              </div>
              <button class="btn btn-primary mx-4 mb-3" onclick="fileId('{{ this._id }}')" data-bs-toggle="modal"
                data-bs-target="#ModalCenters">Share this
                Image</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  {{/each}}
</div>

<!-- Modal -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle"> </h5>
        <button type="button" style="float: right;" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <form role="form" method="post" action="/upload" enctype="multipart/form-data">
        <div class="modal-body">
          <div class="mb-3">
            <label for="formFile" class="form-label">Upload a Image : </label>
            <input class="form-control" type="file" name="file" id="formFile">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Upload Image</button>
        </div>
      </form>
    </div>
  </div>
</div>

{{!-- share public private image modal --}}
<div class="modal fade" id="ModalCenters" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Share this File</h5>
        <button type="button" style="float: right;" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="share-email" class="form-label">Enter a Email</label>
          <input class="form-control" type="email" id="share-email" name="emails" required/>
        </div>
      </div>

      {{!-- email sent successfully code --}}
      <div class="mx-3" id="message">
        <p>Email sent successfully!!</p>
      </div>
      {{!-- email sent successfully code end--}}

      <div class="modal-footer">
        <form id="publicform" onsubmit="publicformsubmit()" method="post">
          <input type="hidden" name="fileId" class="fileId" id="fileId" />
          <input type="hidden" name="emails" id="public-share-email" />
          <button type="submit" onclick="msgdisplay()" class="btn btn-primary mb-3">
            Share Image public</button>
        </form>

        <form id="privateform" onsubmit="privateformsubmit()" method="post">
          <input type="hidden" name="fileId" class="fileId" id="privatefileId" />
          <input type="hidden" name="emails" id="private-share-email" />
          <button type="submit" onclick="msgdisplay()" class="btn btn-primary mb-3">
            Share Image private</button>
        </form>

        <button type="button" class="btn btn-secondary mb-3" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
{{!-- share public private image modal end--}}

{{!-- javascript code start --}}
<script>

  function fileId(fileId) {
    document.getElementById("fileId").value = fileId;
    document.getElementById("privatefileId").value = fileId;
  }

  function msgdisplay() {
    document.getElementById("message").style.display = "block";
  }

  function publicformsubmit() {
    const email = document.getElementById("share-email").value;
    document.getElementById("public-share-email").value = email;
    return document.getElementById("publicform").action = "http://localhost:8000/public"
  }
  function privateformsubmit() {
    const emails = document.getElementById("share-email").value;
    document.getElementById("private-share-email").value = emails;
    return document.getElementById("privateform").action = "http://localhost:8000/permitted"
  }
</script>
{{!-- javascript code end --}}

{{!-- homepage end --}}